<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login & Sign Up Form</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container" id="container">
        <div class="form-container sign-up-container">
            <form id="sign-up-form">
                <h1>Create Account</h1>
                <div class="social-icons">
                    <a href="https://mail.google.com" class="icon" target="_blank"><i class="fa-brands fa-google-plus-g"></i></a>
                    <a href="https://facebook.com" class="icon" target="_blank"><i class="fa-brands fa-facebook-f"></i></a>
                    <a href="https://github.com" class="icon" target="_blank"><i class="fa-brands fa-github"></i></a>
                    <a href="https://linkedin.com" class="icon" target="_blank"><i class="fa-brands fa-linkedin-in"></i></a>
                </div>
                <span>use your email for registration</span>
                <input type="text" id="signup-name" placeholder="Name" required>
                <input type="email" id="signup-email" placeholder="Email" required>
                <input type="password" id="signup-password" placeholder="Password" required>
                <button type="submit">Sign Up</button>
            </form>
        </div>

        <div class="form-container sign-in-container">
            <form id="sign-in-form">
                <h1>Sign In</h1>
                <div class="social-icons">
                    <a href="https://mail.google.com" class="icon" target="_blank"><i class="fa-brands fa-google-plus-g"></i></a>
                    <a href="https://facebook.com" class="icon" target="_blank"><i class="fa-brands fa-facebook-f"></i></a>
                    <a href="https://github.com" class="icon" target="_blank"><i class="fa-brands fa-github"></i></a>
                    <a href="https://linkedin.com" class="icon" target="_blank"><i class="fa-brands fa-linkedin-in"></i></a>
                </div>
                <span>use your email and password</span>
                <input type="email" id="login-email" placeholder="Email" required>
                <input type="password" id="login-password" placeholder="Password" required>
                <a href="#" id="forgot-link">Forget Your Password?</a>
                <button type="submit">Sign In</button>
            </form>

            <div id="reset-form" style="display:none;">
                <h2>Reset Password</h2>
                <input type="email" id="reset-email" placeholder="Enter your email">
                <input type="text" placeholder="OTP"><br>
                <button id="send-otp-btn" type="button">Send OTP</button>&nbsp;&nbsp;&nbsp;
                <button id="submit-otp-btn" type="button">Submit</button><br>
                <a href="#" id="back-to-login"><p style="text-align:center;">Back to Login</p></a>  
            </div>
        </div>

        <div class="toggle-container">
            <div class="toggle">
                <div class="toggle-panel toggle-left">
                    <h1>Welcome Back!</h1>
                    <p>Enter your personal details </p>
                    <button id="login">Sign In</button>
                </div>    
            </div>
        </div>
        <div class="toggle-container">
            <div class="toggle">
                <div class="toggle-panel toggle-right">
                    <h1>Hello, Friend!</h1>
                    <p>Register with your personal details </p>
                    <button id="register">Sign Up</button>
                </div>  
            </div>
        </div>
    </div>
    <script>

        // Toggle logic
        document.getElementById('login').onclick = function() {
            document.getElementById('container').classList.remove("right-panel-active");
        };
        document.getElementById('register').onclick = function() {
            document.getElementById('container').classList.add("right-panel-active");
        };

        // Show sign-in by default, hide sign-up
        document.querySelector('.sign-up-container').style.display = 'none';
        document.querySelector('.sign-in-container').style.display = 'block';

        // Toggle display based on class
        const observer = new MutationObserver(() => {
            if (document.getElementById('container').classList.contains('right-panel-active')) {
                document.querySelector('.sign-up-container').style.display = 'block';
                document.querySelector('.sign-in-container').style.display = 'none';
            } else {
                document.querySelector('.sign-up-container').style.display = 'none';
                document.querySelector('.sign-in-container').style.display = 'block';
            }
        });
        observer.observe(document.getElementById('container'), { attributes: true });

        // Forgot password logic
        document.getElementById('forgot-link').onclick = function(e) {
            e.preventDefault();
            document.getElementById('sign-in-form').style.display = 'none';
            document.getElementById('reset-form').style.display = 'block';
        };

        document.getElementById('back-to-login').onclick = function(e) {
            e.preventDefault();
            document.getElementById('reset-form').style.display = 'none';
            document.getElementById('sign-in-form').style.display = 'block';
        };

        document.getElementById('send-otp-btn').onclick = function(e) {
            e.preventDefault();
            const email = document.getElementById('reset-email').value;
            const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!email) {
                alert('Please enter your email.');
                return;
            }
            if (!emailPattern.test(email)) {
                alert('Please enter a valid email address.');
                return;
            }
            fetch('/send-otp', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('OTP sent to your email!');
                } else {
                    alert('Failed to send OTP.');
                }
            })
            .catch(() => {
                alert('Error sending OTP.');
            });
        };

        document.getElementById('submit-otp-btn').onclick = function(e) {
            e.preventDefault();
            const email = document.getElementById('reset-email').value;
            const otp = document.querySelector('#reset-form input[placeholder="OTP"]').value;
            if (!otp) {
                alert('Please enter the OTP.');
                return;
            }
            fetch('/verify-otp', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email, otp })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('OTP verified! You can now reset your password.');
                    // Redirect to password reset page or show password reset fields here       
                } else {
                    alert('Invalid OTP.');
                }
            })
            .catch(() => {
                alert('Error verifying OTP.');
            });
        };

        document.getElementById('sign-in-form').onsubmit = function(e) {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailPattern.test(email)) {
                alert('Please enter a valid email address.');
                e.preventDefault();
                return false;
            }
            if (password.length < 15) {
                alert('Password must be at least 15 characters.');
                e.preventDefault();
                return false;
            }
        };

        document.getElementById('sign-up-form').onsubmit = function(e) {
            const name = document.getElementById('signup-name').value;
            const email = document.getElementById('signup-email').value;
            const password = document.getElementById('signup-password').value;
            const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!name) {
                alert('Please enter your name.');
                e.preventDefault();
                return false;
            }
            if (!emailPattern.test(email)) {
                alert('Please enter a valid email address.');
                e.preventDefault();
                return false;
            }
            if (password.length < 15) {
                alert('Password must be at least 15 characters.');
                e.preventDefault();
                return false;
            }
        };
    </script>
</body>
</html>